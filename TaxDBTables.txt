CREATE TABLE Individuals 
(
  IndividualDocumentNumber varchar(255),
  FullName varchar(255),
  DOB date, 
  HomeAddress varchar(max),
  Email varchar(255),
  MobileNo varchar(255),
  LandlineNo varchar(255),
  Fax varchar(255),
  Created_Date datetime not null default (getdate()),
  Created_By varchar(255) not null default (system_user),
  Updated_Date datetime,
  Updated_By varchar(255)
CONSTRAINT PK_Individuals_IndividualDocumentNumber PRIMARY KEY(IndividualDocumentNumber)
);

CREATE TABLE Companies
(
  SID int identity(1,1),
  ComapanyCUITNumber varchar(255),
  OwnerDocNo varchar(255),
  OwnerType varchar(1),
  CompanyStartDate date,
  Website varchar(255), 
  Email varchar(255),
  MobileNo varchar(255),
  LanlineNo varchar(255),
  Fax varchar(255),
  Created_Date datetime not null default (getdate()),
  Created_By varchar(255) not null default (system_user),
  Updated_Date datetime,
  Updated_By varchar(255)
CONSTRAINT PK_Companies_SID PRIMARY KEY(SID),
CONSTRAINT FK_Companies_OwnerDocNo FOREIGN KEY(OwnerDocNo) REFERENCES Individuals(IndividualDocumentNumber),
CONSTRAINT UK_Companies_CompanyCUITNumber_OwnerDocNo UNIQUE (ComapanyCUITNumber, OwnerDocNo)
);

CREATE TABLE Agencies
(
  AgencyNumber varchar(255),
  Address varchar(255),
  TelNo varchar(255),
  InchargePerson varchar(255),
  NoOfEmployees int,
  Created_Date datetime not null default (getdate()),
  Created_By varchar(255) not null default (system_user),
  Updated_Date datetime,
  Updated_By varchar(255)
  CONSTRAINT PK_Agencies_AgencyNumber PRIMARY KEY(AgencyNumber)
);

CREATE TABLE TaxCategories
(
  SID int identity(1,1),
  TaxType varchar(255),
  Created_Date datetime not null default (getdate()),
  Created_By varchar(255) not null default (system_user),
  Updated_Date datetime,
  Updated_By varchar(255)
  CONSTRAINT PK_TaxCategories_SID PRIMARY KEY(SID)
);

CREATE TABLE TaxPayments
(
  SID int identity(1,1),
  CollectionAgencyID varchar(255),
  TaxPayerID int,
  TaxAmount decimal,
  PaymentDate date,
  TaxTypeID int,  
  Created_Date datetime not null default (getdate()),
  Created_By varchar(255) not null default (system_user),
  Updated_Date datetime,
  Updated_By varchar(255)
  CONSTRAINT PK_TaxPayments_SID PRIMARY KEY(SID),											
  CONSTRAINT UK_TaxPayments UNIQUE(CollectionAgencyID, TaxPayerID, PaymentDate, TaxTypeID),
  CONSTRAINT FK_TaxPayments_CollectionAgencyID FOREIGN KEY(CollectionAgencyID) REFERENCES Agencies(AgencyNumber),
  CONSTRAINT FK_TaxPayments_TaxPayerID FOREIGN KEY(TaxPayerID) REFERENCES Companies(SID),
  CONSTRAINT FK_TaxPayments_TaxTypeID FOREIGN KEY(TaxTypeID) REFERENCES TaxCategories(SID)
);


